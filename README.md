# 🏭 Agentic AI Incident Analysis System

## 📌 Overview
This project implements an **AI-powered Incident Analysis System** for a manufacturing plant.  
It integrates **IoT sensor data** with a **retrieval-augmented generation (RAG) pipeline** to assist maintenance teams by:

- Collecting structured incident data from IoT sensors / central control systems.  
- Storing past incidents in a **FAISS vector database** for efficient similarity search.  
- Using **LLM reasoning (mistralai/mistral-7b-instruct-v0.3 via LM Studio)** to analyze new incidents against historical data.  
- Providing structured recommendations such as:
  - Potential **risk level**
  - Likely **root cause(s)**
  - Suggested **remedial actions**
  - **Prevention advice**  

The system exposes functionality via:

- **FastAPI REST API** (for ingestion & analysis)  
- **WebSocket / UI layer** (for real-time updates to operators)  
- **Streamlit client** (simple web interface for viewing AI recommendations)  

---

## 🛠️ Project Structure

```bash
Agentic-AI-System/
│── API/
│ └── __init__.py
│ └── app.py                   # FastAPI app
│
│── query/
│ ├── __init__.py
│ └── prompt_logic.py          # LLM + Prompt orchestration
│
│── UI/
│ ├── ui.html                  # frontend UI dashboard
│ └── styles.css
│
│── data/
│ ├── past_incidents.json      # Dataset of 100 past incidents
│ ├── build_index.py
│ └── storage/                 # FAISS vector DB storage
│
│── docs/
│ ├── ArchitectureDiagram.png
│ └── Assumptions_and_Schema.pdf
│
│── test_incidents.txt         # New incidents to try out the Agent
│── requirements.txt
│── README.md
```


---

## ⚡ Setup Instructions

### 1️⃣ Clone Repository
```bash
git clone https://github.com/<your-username>/Agentic_AI_System.git
cd Agentic_AI_System
```

### 2️⃣ Install Dependencies
```bash
pip install -r requirements.txt
```

### 3️⃣ Build Vector Index
```bash
python data/build_index.py
```

### 4️⃣ Run FastAPI Service
```bash
uvicorn API.app:app --reload
```

API will be available at:
👉 http://127.0.0.1:8000

## 📡 Usage
### ✅ REST API

Send a new incident JSON (updated schema):
```bash
{
  "new_incident": {
    "incident_id": "AUTO-INC-002",
    "machine": "Filler Line B",
    "timestamp": "2025-08-18T09:45:00Z",
    "type": "ConveyorJam",
    "measured_value": null,
    "threshold": null,
    "status": "emergency_stop"
  }
}
```

Example call:
```bash
curl -X POST "http://127.0.0.1:8000/analyze_incident/" \
     -H "Content-Type: application/json" \
     -d @sample_incident.json
```
or,
Use FastAPI Swagger UI to send the input to Agent
1. Open FastAPI Swagger UI at http://127.0.0.1:8000/docs
2. Click the first dropdown and click 'try it out'
3. Paste the new incident in JSON format in the space and click execute

### 🚀 Steps to run the Agent
1. Open LM Studio and Load the model (mistralai/mistral-7b-instruct-v0.3) and start server.
2. Run FastAPI by executing ```uvicorn API.app:app --reload ``` in the terminal. (make sure you are in the 'Agentic_AI_System' directory in the terminal)
3. After starting the API, click on ```ui.html``` file and open it in browser.
4. Now open the FastAPI Swagger UI at http://127.0.0.1:8000/docs
5. Paste the new incident in JSON format and click execute.
6. Wait for the output in UI

## 📊 Example Output
```bash
Incident: AUTO-INC-002 | Machine: Filler Line B | Type: ConveyorJam

Risk Level: High

Possible Root Cause(s):
- Misaligned guide rail
- Loose hose connection

Recommended Action(s):
- Adjust the misaligned guide rail
- Tighten loose hose connections
- Clean up any spillage and perform safety checks

Relevant Past Incidents Count: 2
```
## 📐 Architecture
### 📝 Assumptions & Schema

Incidents are generated by IoT sensors on machines.

A central control system converts sensor alerts into structured JSON.

Only incidents (alerts exceeding thresholds or causing shutdowns) are forwarded.

JSON Schema:
```bash
{
  "new_incident": {
    "incident_id": "string",
    "machine": "string",
    "timestamp": "ISO8601 string",
    "type": "string",
    "measured_value": "number | null",
    "threshold": "number | null",
    "status": "string"
  }
}
```
